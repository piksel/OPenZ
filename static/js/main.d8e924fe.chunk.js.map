{"version":3,"sources":["contexts/MidiContext.tsx","components/common.ts","components/Button.tsx","components/Select.ts","components/Flex.ts","components/BigText.ts","themes/default-dark.ts","models/controlLabels.ts","controls/NumberBox.tsx","components/Stretcher.ts","controls/Wheels.tsx","models/midiConstants.ts","controls/Keyboard.tsx","controls/ChannelBox.tsx","App.tsx","serviceWorker.js","index.js"],"names":["React","createContext","webmidi","init","initialized","inputs","Provider","MidiProvider","Consumer","displayName","colorFromProps","props","green","theme","colors","blue","yellow","red","secondary","withCommon","cb","propColor","Button","styled","button","primary","css","Select","select","p","background","Flex","div","row","col","fill","stretch","BigText","h2","disabled","DefaultDarkTheme","borderRadius","main","instPage","adsrPage","lfoPage","fxPage","percParams","synthParams","arpegParams","fxParams","numbParams","Array","from","_","x","y","toString","padStart","controlLabels","group","params","NumberBox","value","label","color","style","height","textAlign","fontSize","fontWeight","lineHeight","marginTop","width","alignItems","justifyContent","Stretcher","MidiBeatMessageType","Wheels","wheels","channel","map","index","page","key","WheelBackground","pageColors","Wheel","hasValue","fmtValue","Math","ceil","toFixed","rotation","display","flexDirection","padding","border","opacity","transform","marginRight","marginLeft","noteNames","NoteKey","black","pressed","noteColor","Keyboard","notes","onKeyClicked","position","instrument","octIndex","octave","noteName","cleanNote","replace","includes","keyOn","keyOff","onMouseDown","onMouseUp","onMouseLeave","onMouseEnter","e","buttons","ChannelBox","state","number","playing","note","PlayMain","channels","flexWrap","i","JamMain","keyClicked","HeadLeft","HeadRight","AppRoot","AppHeader","AppMain","App","useState","input","setInput","output","setOutput","setChannel","setChannels","project","setProject","setNotes","setWheels","bpm","tempo","setTempo","lastBeat","pulses","setClock","updateNote","modNote","cs","c","ps","v","useEffect","console","log","enable","error","addListener","event","setMidi","m","window","opz","logEvent","bytes","type","data","b","join","removeListener","control","wheelNumber","floor","pw","undefined","updateWheel","controller","messageType","timestamp","Clock","t","round","Stop","pattern","opzo","midi","length","outputs","onClick","id","onChange","find","target","name","cursor","down","playNote","velocity","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.d8e924fe.chunk.js","sourcesContent":["import React from \"react\";\nimport webmidi, {Input, WebMidi} from \"webmidi\";\n\n\nexport interface IMidiContext {\n  webmidi: WebMidi;\n  init(): void;\n  error?: Error;\n  initialized: boolean;\n  inputs: Input[];\n}\n\nconst {Provider, Consumer, displayName} = React.createContext<IMidiContext>({\n  webmidi,\n  init(){},\n  initialized: false,\n  inputs: [],\n});\n\nexport const [ MidiProvider, MidiConsumer, MidiName ] = [ Provider, Consumer, displayName ];","import {DefaultTheme, FlattenSimpleInterpolation, ThemeProps} from \"styled-components/macro\";\n\nexport interface CommonProps {\n  primary?: boolean;\n  red?: boolean;\n  green?: boolean;\n  blue?: boolean;\n  yellow?: boolean;\n}\n\ntype PropsArg = CommonProps & ThemeProps<DefaultTheme>;\ntype PropsArgWithCommon = PropsArg & { propColor: string };\n\nexport const colorFromProps = (props: PropsArg) =>\n  props.green ? props.theme.colors.green :\n    props.blue ? props.theme.colors.blue :\n      props.yellow ? props.theme.colors.yellow :\n        props.red ? props.theme.colors.red :\n          props.theme.colors.secondary;\n\ntype PropsFun<T = PropsArg> = (props: T) => FlattenSimpleInterpolation;\n\nexport const withCommon = (cb: PropsFun<PropsArgWithCommon>) =>\n  (props: CommonProps & ThemeProps<DefaultTheme>) =>\n    cb({...props, propColor: colorFromProps(props)})","import styled, {css} from 'styled-components/macro'\nimport {colorFromProps, CommonProps, withCommon} from \"./common\";\n\n\nexport const Button = styled.button<CommonProps>`\n  background: transparent;\n  border-radius: 3px;\n  border: 2px solid transparent;\n  margin: 0.5em 1em;\n  padding: 0.25em 1em;\n\n  ${withCommon(props => props.primary ? css`\n    background: ${colorFromProps(props)};\n    color: white;\n  ` : css`\n    color: ${colorFromProps(props)};\n    border-color: ${colorFromProps(props)};\n  `)}\n`","import styled, {css} from \"styled-components/macro\";\nimport {colorFromProps, CommonProps, withCommon} from \"./common\";\n\n\nexport const Select = styled.select<CommonProps>`\n  background: transparent;\n  border-radius: 3px;\n  border: 2px solid transparent;\n  margin: 0.5em 1em;\n  padding: 0.25em 1em;\n\n  ${withCommon(props => props.primary ? css`\n    background: ${colorFromProps(props)};\n    color: white;\n  ` : css`\n    color: ${colorFromProps(props)};\n    border-color: ${colorFromProps(props)};\n  `)}\n  \n  option {\n    background: ${p => p.theme.colors.background};\n    padding: .4rem .1rem;\n  }\n`;\n","import styled from \"styled-components\";\n\nexport const Flex = styled.div<{ row?: boolean, col?: boolean, fill?: boolean, stretch?: boolean }>`\n  display: flex;\n  flex-direction: ${p => p.row ? 'row' : p.col ? 'column' : 'inherit'};\n  flex: ${p => p.fill ? '1' : 'none'};\n  justify-content: ${p => p.stretch ? 'stretch' : 'normal'};\n  user-select: none;\n`;","import styled from \"styled-components\";\n\nexport const BigText = styled.h2<{ disabled?: boolean }>`      \n    font-size: 6rem;\n    line-height: 1em;\n    width: 2em;\n    text-align: center;\n    font-weight: 300;\n    height: 1em;\n    margin: -.5rem 0 0 0;\n    opacity: ${p => p.disabled ? .5 : 1};\n`;","import {DefaultTheme} from 'styled-components/macro'\n\nexport const DefaultDarkTheme: DefaultTheme = {\n  borderRadius: '5px',\n\n  colors: {\n    main: '#f5b900',\n    secondary: '#f0f0f0',\n\n    green: '#1c6406',\n    blue: '#0062f5',\n    yellow: '#f5b900',\n    red: '#ab0b0b',\n\n    background: '#707070'\n  },\n}","/*\nkick / snare / hihat / perc\n\n   green blue yellow red\nw  pitch  revers filter resonance\ng  attack decay  sustn  release\np  lfoAmt lfoSpd lfoTgt lfoShp\ny  fx1Snd fx2Snd pan    level\n */\n\n/*\nparam 1 param 2 filter resonance\nattack decay sustain release\nlfoamount lfospeed lfotarget lfoshape\nfx1send fx2send pan level\n */\n\ninterface ControlLabel {\n  group: string;\n  params: string[][];\n}\n\nconst instPage = ['Param 1', 'Param 2', 'Filter', 'Resonance'];\nconst percPage = ['Pitch', 'Reverse', 'Filter', 'Resonance'];\nconst adsrPage = ['Attack', 'Decay', 'Sustain', 'Release'];\nconst lfoPage = ['LFO Amount', 'LFO Speed', 'LFO Target', 'LFO Shape'];\nconst fxPage = ['FX1 Send', 'FX2 Send', 'Pan', 'Level'];\nconst arpPage = ['Arp. Speed', 'Arp. Pattern', 'Arp. Style', 'Arp. Range'];\nconst tapePage = ['Speed', 'Fine Tune', 'Filter', 'Resonance'];\nconst mastPage = ['Chorus', 'Drive', 'Filter', 'Resonance'];\nconst lightPage = ['Color', 'Alt Color', 'Speed', 'Intensity'];\n\nconst percParams = [percPage, adsrPage, lfoPage, fxPage];\nconst synthParams = [instPage, adsrPage, lfoPage, fxPage];\nconst arpegParams = [instPage, adsrPage, arpPage, fxPage];\nconst fxParams = [instPage, lfoPage];\nconst numbParams = Array.from(Array(4), (_, x) => Array.from(Array(4), (_, y) => (x * 4 + y).toString(10).padStart(2, '0')))\n\nexport const controlLabels: ControlLabel[] = [\n  {group: '', params: [['---', '---', '---', '---']]},\n  {group: 'KCK', params: percParams},\n  {group: 'SNR', params: percParams},\n  {group: 'PCS', params: percParams},\n  {group: 'SMP', params: percParams},\n  {group: 'BAS', params: synthParams},\n  {group: 'LEA', params: synthParams},\n  {group: 'ARP', params: arpegParams},\n  {group: 'CHO', params: synthParams},\n  {group: 'FX1', params: fxParams},\n  {group: 'FX2', params: fxParams},\n  {group: 'TAP', params: [tapePage, fxPage]},\n  {group: 'MAS', params: [mastPage]},\n  {group: 'PRF', params: [[]]},\n  {group: 'MOD', params: numbParams},\n  {group: 'LGT', params: [lightPage, numbParams[1]]},\n  {group: 'MTN', params: [[]]},\n];","import {Flex} from \"../components\";\nimport React from \"react\";\n\nexport const NumberBox = (props: { value: number | string, label: string, color?: string }) => {\n  const {value, label, color} = props;\n  return (\n    <Flex col style={{height: '5rem',}}>\n      <div style={{\n        textAlign: 'right', fontSize: '4rem', fontWeight: 300,\n        lineHeight: '1em',\n        height: '1em',\n        marginTop: '-.5rem',\n        width: '8rem',\n\n      }}>{value}</div>\n      <Flex row style={{\n        alignItems: 'center',\n        justifyContent: 'space-between',\n      }}>\n        <div style={{\n          width: '1.2rem',\n          height: '1.2rem',\n          borderRadius: '50%',\n          background: color ?? 'transparent'\n        }}/>\n        <div style={{textAlign: 'right', fontSize: '1.2rem'}}>{label}</div>\n\n      </Flex>\n    </Flex>\n  )\n}","import styled from \"styled-components\";\n\nexport const Stretcher = styled.div`\n  flex: 1;\n`","import styled, {css} from \"styled-components/macro\";\nimport {CommonProps, withCommon} from \"../components/common\";\nimport {controlLabels} from \"../models/controlLabels\";\nimport React from \"react\";\nimport {NumberBox} from \"./NumberBox\";\nimport {BigText, Flex} from \"../components\";\nimport {Stretcher} from \"../components/Stretcher\";\n\nexport const Wheels = (props: { wheels: { value?: number, channel: number, page: number }[] }) => {\n  const {wheels} = props;\n\n  return (<Flex row fill>\n    <BigText>{controlLabels[wheels[0].channel]?.group}</BigText>\n    <Stretcher/>\n    {wheels.map(({value, channel, page}, index) =>\n\n      <Wheel key={index} index={index} value={value} channel={channel} page={page}/>\n    )}\n  </Flex>)\n}\n\nconst WheelBackground = styled.div<CommonProps>`\n  border-radius: 50%;\n  color: black;\n  ${withCommon(p => css`\n    background-color: ${p.propColor}\n  `)}\n`;\n\nconst pageColors = [\n  '#ffffff',\n  '#1fc400',\n  '#6300c1',\n  '#e99500',\n]\n\nconst Wheel = (props: { index: number, value?: number, channel: number, page: number }) => {\n  const {index, value, channel, page} = props;\n\n  const {params} = controlLabels[channel] || {params: [[]]}\n\n  const hasValue = typeof value === 'number';\n  const fmtValue = hasValue ? Math.ceil((value ?? 0) / 1.28).toFixed(0) : 'XX';\n  const rotation = -135 + ((value ?? 64) * 2.109375);\n\n  return (<div style={{\n    display: 'flex',\n    flexDirection: 'row',\n    padding: '0 1rem',\n    border: '1px #ff00ff00 dashed',\n    opacity: hasValue ? 1 : .5\n  }}>\n    <WheelBackground\n      style={{transform: `rotateZ(${rotation}deg)`, width: '5rem', height: '5rem', marginRight: '.5rem'}}\n      green={index === 0}\n      blue={index === 1} yellow={index === 2}\n      red={index === 3}>\n      <div style={{marginLeft: 'auto', marginRight: 'auto', background: 'black', width: '2px', height: '50%'}}/>\n    </WheelBackground>\n    <NumberBox value={`${fmtValue}%`}\n               color={pageColors[page]}\n               label={params[page]?.[index] || `🤷‍ 0x${channel.toString(16).padStart(2, '0')} ${index.toString(16).padStart(2, '0')}`}/>\n  </div>)\n}","export enum MidiBeatMessageType {\n  Clock = 248,\n  Start = 250,\n  Continue = 251,\n  Stop = 252,\n}\n\nexport const noteNames = [\n  'F',\n  'F♯',\n  'G',\n  'G♯',\n  'A',\n  'A♯',\n  'B',\n  'C',\n  'C♯',\n  'D',\n  'D♯',\n  'E',\n  'F',\n  'G♭',\n  'G',\n  'A♭',\n  'A',\n  'B♭',\n  'B',\n  'C',\n  'D♭',\n  'D',\n  'E♭',\n  'E',\n];","import styled, {css} from \"styled-components/macro\";\nimport {NoteSet} from \"../models\";\nimport React from \"react\";\nimport {noteNames} from \"../models/midiConstants\";\n\nconst NoteKey = styled.div<{ pressed: boolean, black: boolean, noteColor: number }>`\n  user-select: none;\n  vertical-align: bottom;\n  display: flex;\n  align-items: flex-end;\n  justify-content: center;\n  border-radius: .5rem;\n  border-top: .1rem solid black;\n  font-size: 1.4rem;\n  font-weight: 300;\n  padding-bottom: .5rem;\n  //box-shadow: 0 0 5px #00000080;\n  pointer-events: all;\n  ${p => p.black ? css`\n      background-color: ${p.pressed ? `hsl(${p.noteColor}, 90%, 30%)` : 'black'};\n      color: white;\n      height: 6rem;\n      margin: 0 -2.38095238095238%;\n      //position: absolute;\n      width: 2rem;\n      z-index: 2;\n      flex: 2;\n      \n  ` : css`\n      background-color: ${p.pressed ? `hsl(${p.noteColor}, 90%, 70%)` : 'white'};\n      color: black;\n      height: 10rem;\n      flex: 3;\n      width: 3rem;\n      border-right: .1rem solid black;\n  `}\n  ${p => p.pressed && css`box-shadow: 0 0 .1rem #ff518c`}\n`\n\n\n\nexport const Keyboard = (props: { notes: NoteSet, onKeyClicked: (key: string, octave: number, down: boolean) => void }) => {\n  const {notes, onKeyClicked} = props;\n\n  return (<div style={{display: 'flex', flexDirection: 'row', position: 'relative'}}>\n    {notes.map(({pressed, instrument}, index) => {\n        const octIndex = index % 12;\n        const octave = index > 18 ? 5 : index > 6 ? 4 : 3;\n        const noteName = noteNames[index];\n        const cleanNote = noteName.replace('♯', '#').replace('♭', 'b');\n        const black = [1, 3, 5, 8, 10].includes(octIndex);\n        const keyOn = () => onKeyClicked(cleanNote, octave, true);\n        const keyOff = () => onKeyClicked(cleanNote, octave, false);\n\n        return <NoteKey pressed={pressed} black={black} onMouseDown={keyOn} onMouseUp={keyOff} onMouseLeave={keyOff}\n                        noteColor={instrument * 45}\n                        onMouseEnter={e => e.buttons === 1 && keyOn()}\n                        key={index}>{noteName}</NoteKey>\n      }\n    )}\n\n  </div>)\n}","import {Flex} from \"../components\";\nimport React from \"react\";\nimport {ChannelState} from \"../models/stateModels\";\nimport {controlLabels} from \"../models/controlLabels\";\nimport {noteNames} from \"../models/midiConstants\";\n\nexport const ChannelBox = (props: { state: ChannelState, number: number }) => {\n  const {state, number} = props;\n  const {playing, note} = state;\n\n\n  const color = `hsl(${((number + 1) % 8) * 45}, 90%, 70%)`;\n  const label = controlLabels[number + 1].group;\n\n  return (\n    <Flex col style={{\n      height: '7rem',\n\n      color: playing ? 'white' : color,\n\n\n    }}>\n      <div style={{\n        textAlign: 'center', fontSize: '4rem', fontWeight: 300,\n        lineHeight: '1em',\n        height: '1em',\n        marginTop: '-.5rem',\n        width: '8rem',\n        opacity: playing ? 1 : .2\n      }}>{typeof note === 'undefined' ? '' : noteNames[note]}</div>\n\n\n      <div style={{\n        textAlign: 'center', fontSize: '2.2rem', fontWeight: 300, background: playing ? color : '#ffffff20'//'transparent'\n      }}>{label}</div>\n\n    </Flex>\n  )\n}","import React, {useEffect, useState} from 'react';\nimport './App.css';\nimport {IMidiContext, MidiProvider} from './contexts/MidiContext';\nimport webmidi, {IEventController, IEventNote, Input, InputEvents, Output} from \"webmidi\";\nimport {BigText, Button, Flex, Select} from \"./components\";\nimport styled, {ThemeProvider} from \"styled-components/macro\";\nimport {DefaultDarkTheme} from \"./themes\";\nimport {NoteSet} from \"./models\";\nimport {Keyboard, NumberBox, Wheels} from \"./controls\";\nimport {MidiBeatMessageType} from \"./models/midiConstants\";\nimport {ChannelState, ProjectInfo, WheelInfo} from \"./models/stateModels\";\nimport {ChannelBox} from \"./controls/ChannelBox\";\n\nconst fmtBytes = (bytes: Uint8Array) => Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join(' ');\n\n\nconst App = () => {\n  const [input, setInput] = useState<Input | null>();\n  const [output, setOutput] = useState<Output | null>();\n\n  const [channel, setChannel] = useState<number>(0);\n  const [channels, setChannels] = useState<ChannelState[]>(Array.from(new Array(16), _ => ({playing: false})));\n  const [project, setProject] = useState<ProjectInfo>({});\n\n  const [notes, setNotes] = useState<NoteSet>(Array.from(new Array(24), _ => ({pressed: false, instrument: 0})));\n\n  const [wheels, setWheels] = useState<WheelInfo[]>(Array.from(new Array(4), _ => ({\n    channel: 0,\n    page: 0\n  })))\n\n  const [tempo, setTempo] = useState({bpm: 0, playing: false});\n  const [, setClock] = useState({lastBeat: 0, pulses: 0});\n\n  const updateNote = (note: IEventNote, channel: number, pressed: boolean) => {\n    const modNote = (note.number - 5) % 24;\n    //setNoteOffset(note.number - shiftNote);\n\n    setChannels(cs => cs.map((c, i) => i === channel - 1 ? {playing: pressed, note: modNote} : c));\n\n    setChannel(channel);\n    setNotes(ps => {\n      return ps.map((v, i) => i === modNote ? {\n        pressed,\n        instrument: channel,\n      } : v);\n    });\n    if (pressed) {\n      // console.log(`Key ${note.name}${note.octave} ${state ? 'pressed' : 'released'} on channel ${channel}, raw: ${note.number}`)\n    }\n  }\n\n  const updateWheel = (control: IEventController, channel: number, value: number) => {\n    const wheelNumber = (control.number - 1) % 4;\n    const page = Math.floor((control.number - wheelNumber) / 4);\n    // console.log(`Wheel update for channel: ${channel}, page: ${page} (${(control.number - wheelNumber)}), wheel: ${wheelNumber}, new value: ${value}`);\n    setWheels(pw => pw.map((v, i) => i === wheelNumber ? {value, channel, page} : {\n      page,\n      channel,\n      value: v.page === page && v.channel === channel ? v.value : undefined\n    }));\n  }\n\n  const updateClock = (messageType: MidiBeatMessageType, timestamp: number) => {\n\n    if (messageType === MidiBeatMessageType.Clock) {\n      // 1200 = 100bpm\n      //  600 = 200bpm\n\n      setClock(c => {\n        if (c.pulses === 47) { // 1/4 == 24 pulses, so 48 pulses == 2/4\n          setTempo(t => ({...t, bpm: Math.round(120000 / (timestamp - c.lastBeat))}))\n          return {\n            lastBeat: timestamp,\n            pulses: 0,\n          };\n        } else return {\n          lastBeat: c.lastBeat || timestamp,\n          pulses: c.pulses + 1,\n        }\n      })\n    } else {\n      setTempo(t => ({...t, playing: messageType !== MidiBeatMessageType.Stop}));\n    }\n\n\n  }\n\n  useEffect(() => {\n    console.log('init!')\n    webmidi.enable(error => {\n      if (!error) {\n        webmidi.addListener('connected', event => {\n          console.log('Connected!', event);\n        });\n        webmidi.addListener('disconnected', event => {\n          console.log('Disconnected!', event);\n        });\n\n      }\n      setMidi(m => ({...m, error, initialized: !error, inputs: webmidi.inputs}));\n    });\n  }, []);\n\n  useEffect(() => {\n    (window as any).opz = input;\n    const logEvent = (e: InputEvents[keyof InputEvents]) => {\n      console.log(e.type, fmtBytes(e.data));\n    }\n    input?.removeListener();\n\n    input?.addListener(\"controlchange\", \"all\", (e) => updateWheel(e.controller, e.channel, e.value));\n    input?.addListener(\"noteon\", \"all\", (e) => updateNote(e.note, e.channel, true));\n    input?.addListener(\"noteoff\", \"all\", (e) => updateNote(e.note, e.channel, false));\n    input?.addListener(\"clock\", \"all\", e => updateClock(e.data[0], e.timestamp));\n    input?.addListener(\"channelmode\", \"all\", logEvent);\n    input?.addListener(\"activesensing\", \"all\", logEvent);\n    input?.addListener(\"songposition\", \"all\", logEvent);\n    input?.addListener(\"sysex\", \"all\", logEvent);\n    input?.addListener(\"unknownsystemmessage\", \"all\", logEvent);\n    input?.addListener(\"tuningrequest\", \"all\", logEvent);\n    input?.addListener(\"programchange\", \"all\", e => setProject(p => ({...p, number: e.channel, pattern: e.value})));\n    input?.addListener(\"reset\", \"all\", logEvent);\n    input?.addListener(\"start\", \"all\", () => setProject(p => ({...p, playing: true})));\n    input?.addListener(\"stop\", \"all\", () => setProject(p => ({...p, playing: false})));\n\n    //input?.addListener(\"midimessage\", undefined, logEvent);\n  }, [input]);\n\n  useEffect(() => {\n    (window as any).opzo = output;\n\n    //output?.sendControlChange(102, 1, 0);\n\n    //input?.addListener(\"midimessage\", undefined, logEvent);\n  }, [output]);\n\n  const [midi, setMidi] = useState<IMidiContext>({\n    webmidi,\n    init() {\n\n    },\n    initialized: false,\n    inputs: [],\n  });\n\n  useEffect(() => {\n    if (!input && midi.inputs.length > 0) {\n      setInput(midi.inputs[0]);\n    }\n    if (!output && midi.webmidi.outputs.length > 0) {\n      setOutput(midi.webmidi.outputs[0]);\n    }\n\n  }, [midi, input, output]);\n\n  const keyClicked = (key: string, octave: number, down: boolean) => {\n\n    //console.log(`Playing ${key}${octave} on channel ${channel || 1}`);\n\n    try {\n      output?.playNote(`${key}${octave}`, channel || 1, {\n        velocity: down ? .5 : 0,\n      });\n    } catch (e) {\n      console.error('Failed to play note ')\n    }\n  }\n\n\n\n  return (\n    <ThemeProvider theme={DefaultDarkTheme}>\n      <MidiProvider value={midi}>\n        <AppRoot>\n          <AppHeader>\n            <HeadLeft>\n              MIDI\n              <Button primary blue disabled={midi.initialized}\n                      onClick={() => midi.init()}>{midi.initialized ? 'Enabled!' : 'Enable'}</Button>\n              <pre>{midi?.error ?? ''}</pre>\n              <label>\n                Input:\n                <Select value={input?.id} onChange={(e) => setInput(midi.inputs.find(i => i.id == e.target.value))}>\n                  <option value={''}>{midi.inputs.length > 0 ? 'Select a midi input' : 'No inputs detected'}</option>\n                  {midi.inputs.map(input => <option key={input.id} value={input.id}>{input.name}</option>)}\n                </Select>\n              </label>\n              <label>\n                Output:\n                <Select value={output?.id}\n                        onChange={(e) => setOutput(webmidi.outputs.find(({id}) => id == e.target.value))}>\n                  <option\n                    value={''}>{webmidi.outputs.length > 0 ? 'Select a midi output' : 'No outputs detected'}</option>\n                  {midi.webmidi.outputs.map(({id, name}) => <option key={id} value={id}>{name}</option>)}\n                </Select>\n              </label>\n            </HeadLeft>\n            <HeadRight>\n              <></>\n            </HeadRight>\n          </AppHeader>\n          <AppMain>\n            <Flex row style={{padding: '2rem', alignItems: 'center', justifyContent: 'space-between'}}>\n              <Flex row style={{cursor: 'pointer'}} onClick={() => setProject(p => ({...p, playing: !p.playing}))}>\n                <BigText disabled={project.playing}>{'JAM'}</BigText>\n                <BigText style={{width: '2rem'}}>/</BigText>\n                <BigText disabled={!project.playing}>{'PLY'}</BigText>\n              </Flex>\n              <Flex row>\n                <NumberBox value={project.number?.toString()?.padStart(2, '0') ?? 'XX'} label='PROJECT'/>\n                <NumberBox value={project.pattern?.toString()?.padStart(2, '0') ?? 'XX'} label='PATTERN'/>\n\n                <NumberBox value={tempo.bpm.toFixed(0)} label='BPM'/>\n              </Flex>\n            </Flex>\n            {project.playing ? <PlayMain {...{channels, notes}} /> :\n              <JamMain {...{channel, notes, wheels, keyClicked}} />}\n\n          </AppMain>\n        </AppRoot>\n      </MidiProvider>\n    </ThemeProvider>\n  );\n}\n\n/*\nconst channelNames = ['None', 'Kick', 'Snare', 'Percussion', 'Sample', 'Bass', 'Lead', 'Arp', 'Chord',\n  'Fx 1', 'Fx 2', 'Tape', 'Master', 'Perform', 'Module', 'Lights', 'Motion'];\n */\nconst PlayMain = (props: { channels: ChannelState[], notes: NoteSet }) => {\n  const {channels, notes} = props;\n\n\n  return (\n    <>\n      <Flex stretch row style={{padding: '2rem', flexWrap: 'wrap', height: '14rem'}}>\n        {channels.map((channel, i) => (<>\n          <Flex row style={{\n            width: '12.5%',\n            justifyContent: 'center',\n          }}>\n            <ChannelBox state={channel} number={i}/>\n          </Flex>\n        </>))}\n      </Flex>\n      <div style={{padding: '2rem'}}>\n        <Keyboard notes={notes} onKeyClicked={() => {\n        }}/>\n      </div>\n    </>)\n}\n\nconst JamMain = (props: { channel: number, notes: NoteSet, wheels: WheelInfo[], keyClicked: any }) => {\n\n  //{{ /* Instrument: {channelNames.length > channel ? channelNames[channel] : `Unknown (${channel})`} */}}\n\n  const {notes, wheels, keyClicked} = props;\n  return (\n    <>\n      <Flex stretch row style={{padding: '2rem', height: '14rem'}}>\n        <Wheels wheels={wheels}/>\n      </Flex>\n      <div style={{padding: '2rem'}}>\n\n        <Keyboard notes={notes} onKeyClicked={keyClicked}/>\n      </div>\n    </>\n  )\n}\n\nconst HeadLeft = styled.div`\ndisplay: flex;\npadding: 0 .5rem;\nalign-items: center;\nflex-direction: row;`;\n\nconst HeadRight = HeadLeft;\n\nconst AppRoot = styled.div`\nbackground: ${p => p.theme.colors.background};\ndisplay: flex;\nflex-direction: column;\n\njustify-content: center;\ncolor: white;\nmin-height: 100vh;\n`;\n\nconst AppHeader = styled.div`\ndisplay: flex;\nflex-direction: row;\nalign-items: center;\njustify-content: space-between;\n\n`;\n\nconst AppMain = styled.div`\ndisplay: flex;\nflex-direction: column;\nalign-items: stretch;\njustify-content: flex-start;\nflex: 1;\n`;\n\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}